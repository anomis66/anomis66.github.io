<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<!-- The above meta tags *must* come first in the head; any other head content must come *after* these tags -->

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />

<!-- For IE 9 and below. ICO should be 32x32 pixels in size -->
<!--[if IE]><link rel="shortcut icon" href="./../../includes/images/favicon.ico"><![endif]-->

<!-- Touch Icons - iOS and Android 2.1+ 180x180 pixels in size. --> 
<link rel="apple-touch-icon-precomposed" href="./../../includes/images/anomis66_jack_180s.png">

<!-- Firefox, Chrome, Safari, IE 11+ and Opera. 196x196 pixels in size. -->
<link rel="icon" href="./../../includes/images/anomis66_jack_196s.png">

<title>simonarthur.co.uk</title>
<meta name="author" content="Simon Arthur (@anomis66)">


<link rel="stylesheet" href="https://maxcdn.icons8.com/fonts/line-awesome/1.1/css/line-awesome-font-awesome.min.css">

<link rel="stylesheet" href="./../../includes/css/sanitize.css?v8.0.0">
<!-- link rel="stylesheet" href="./../../includes/css/diagnostic.css?v1.0" -->
<link rel="stylesheet" href="./../../includes/css/default.css">
<link rel="stylesheet" href="./../../includes/css/movie.css">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="./../../includes/scripts/default.js"></script>

</head>

<body>

<header>

	<a href="/" title="Home" class="right"><img src="./../../includes/images/anomis66_jack_100s.png" alt="anomis66" title="Logo" class="logo"></a>

	<h1>My Movie Collection</h1>

	<nav class="hidden-print">
		<a href="./../../family/tree/" title="My Family Tree">Family Tree</a><span class="sr-only"> | </span>
		<a href="./../../family/book/" title="My Book Library">Book Library</a><span class="sr-only"> | </span>
		<a href="./../../family/movi/" title="My Movie Collection" class="active">Movie Collection</a><span class="sr-only"> | </span>
	</nav>

</header>
	
<article>

<p class="lead">
	A listing of my DVD and Blu-ray collection.
</p>
<p class="hidden-print">
	This started life as a <a href="https://www.postgresql.org/" title="PostgreSQL: The World's Most Advanced Open Source Relational Database">PostgreSQL</a> learning exercise.  
	Soon it became something using <a href="//www.omdbapi.com/" title="The OMDb API is a RESTful web service to obtain movie information">OMDb API</a> and a learning tool more useful to me. 
	Here's <a href="https://m.imdb.com/user/ur90560186/checkins?sort=list_order%2Cdesc&view=grid" title="My IMDB Check-In list">what I've been watching</a> recently.
</p>



<form action="#" class="hidden-print">
	<div><input type="text" name="quicksearch" id="quicksearch" placeholder="Quick filter" autofocus></div>
</form>



<div id="csv-count" class="center">
	<div id="loading"><img src="../../includes/images/loading-gray.gif" alt="Loading ... " title="Loading ... please wait"></div>
</div>



<div id="csv-list" class="movie">&nbsp;</div>



<script>

// Executes when complete page is fully loaded, including all frames, objects and imageâ€¦
// $(window).load(function() {

// Executes when HTML-Document is loaded and DOM is ready
// $(document).ready(function () {

$(document).ready(function () {

	/* ----- ----- ----- *
	 * jQuery .filter() Search
	 * https://stackoverflow.com/questions/7051800/how-to-build-a-simple-table-filter-with-jquery
	 * ----- ----- ----- */

	$("#quicksearch").on("keyup", function() {
		var value = $(this).val().toLowerCase();
		$("#table .record").filter(function() {
			$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
		});
	});

});



/* ----- ----- ----- *
 * LOAD CSV OF MOVIES
 * ----- ----- ----- */
document.getElementById("loading").style.display = ""; // show the loading image

if (window.XMLHttpRequest) {
	// ---- Code for IE7+, Firefox, Chrome, Opera, Safari -----
	xhttp=new XMLHttpRequest();
} 
else {  
	// ----- Code for IE6, IE5 -----
	xhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xhttp.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200) {
		document.getElementById("loading").style.display = "none"; // hide the loading image
		doStuff(this.responseText); // if successful do stuff with it.
	}
};
var rnd = (Math.random() * (1000-0+1) ) << 0; // random() cache buster;
xhttp.open("GET", "myfilms.tsv?" + rnd, true);
xhttp.send();

// FUNCTION TO DO STUFF WITH AJAX RESPONSE
function doStuff(file) {
	// Add SPACE after commas.
	file = file.replace(/(?:\,)/g, ', ');				
	// replace DELIMITER with next record code
	file = file.replace(/(?:\|)/g, '</span><span>');
	// replace EOL with next record code
	file = file.replace(/(?:\r\n|\r|\n)/g, '</span></div><div class="record"><span>');  
	// replace \N with space
	file = file.replace(/(?:\\N)/g, '&nbsp;');
	// top & tail the output to ensure valid html
	document.getElementById("csv-list").innerHTML = '<div id="table"><div class="record"><span>' + file + '</div></div>';
}

// RECORD COUNT -----
var myFileUri = "myfilms.tsv";
tsvCount(myFileUri);

function tsvCount(myFile){
// Use jQuery to get -----
	$.get(myFile, function(data) {
		var lineCount = data.split('\n').length;
		var count = lineCount-2; // Remove header and footer lines -----
		document.getElementById("csv-count").innerHTML = '<span class="lead warning">' + count + ' entries.</span>';
	})
}
</script>

</article>

<footer>

	<p class="hidden-print">
		<a href="/" title="Home">Home</a> | 
		&copy; 2018 - Simon Arthur.  All rights reserved.
	</p>

	<!-- MOBILE QR CODE -->
	<div id="qrcode"></div>

</footer>



<script type="text/javascript">
	//<![CDATA[
	function qrcode(url){
		var code = ('<img src="https://chart.googleapis.com/chart?chs=100x100&amp;cht=qr&amp;choe=UTF-8&amp;chl='+url+'" alt="QR code">');
		document.getElementById("qrcode").innerHTML = code;
	}
	qrcode(location.href);
	//]]>
</script>

</body>

</html>
